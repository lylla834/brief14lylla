BRIEF 14

Objectif : Déploiement d'une infrastructure avec Terraform, construction d'un conteneur Docker,
envoi de l'image sur Docker Hub et orchestration du déploiement sur deux machines virtuelles à l'aide de Jenkins

1 Cloner le git du brief14
2 Script pour installation docker dans terraform 
3 Executer le Dockerfile via la commande : docker build -t img_app_py .
4 lancer le script in




Pensez à configuer le serveur Jenkins avec tous les logiciels necessaire : ici ajout de plugin Terraform et git 


CREATION JENKINSFILE :

pipeline {
    agent any
    
    stages {
        stage('git') {
            steps {
                checkout scmGit(branches: [[name: '*/main']], extensions: [], userRemoteConfigs: [[url: 'https://github.com/lylla834/brief14lylla']])
            }
        }  
        stage('Terraform init') {
            steps {
                sh "terraform init"
            }
        }
        
        stage('Terraform plan') {
            steps {
                sh "terraform plan"
            }
        }
        
        stage('Terraform apply') {
            steps {
                sh "terraform apply -auto-approve"
            }
        }
    
        stage ('Terraform-Init Prod') {
            steps {
                sh "cd prod && terraform init"
            }                
        }

        stage ('Terraform-Plan Prod') {
            steps {
                sh "cd prod && terraform plan"
            }
        }

        stage ('Terraform-Apply Prod') {
            steps {
                sh "cd prod && terraform apply -auto-approve"
            }
        }  
    }
}




INSTALLATION MONITORING /

-allez sur AZURE puis
- RESSOURCE_GROUPE
- INSIGHT
- CALCULER
- VM
- SUPERVION à coter de propriété
Puis 
ENABLE ACTIVER 

sudo rm -rf brief14lylla pour supprimer un dossier
docker run -p 3000:3000 -d <nom_de_l_image>



